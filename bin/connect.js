#!/usr/bin/env node
SETTINGS_PATH="/Users/gaya/Workspace/midi-host/midi.settings.json",(()=>{var t={3992:t=>{t.exports=function(t){const e=/^client (\d*): '(.*)' \[(.*)]\n(\s.+\n?)+/gm,n=[];let r;for(;r=e.exec(t);){const[t,e,s]=r,o=parseInt(e,10);if(0===o||s.indexOf("Through")>-1)continue;const c={name:s,id:o,ports:[]},i=/^\s+(\d+).+/gm;let a;for(;a=i.exec(t);){const[t,e]=a;c.ports.push(parseInt(e,10))}n.push(c)}return n}},6451:(t,e,n)=>{const r=n(7147),s=n(2037),{exec:o}=n(2081),c=process.env.SETTINGS_PATH||SETTINGS_PATH||`${s.homedir()}/midi.settings.json`;function i(t,e){const n=t[e.name];return void 0===n?1:n}t.exports={getDeviceSetting:i,canMidiIn:function(t,e){switch(i(t,e)){case 1:case 2:return!0;default:return!1}},canMidiOut:function(t,e){switch(i(t,e)){case 1:case 3:return!0;default:return!1}},loadSettings:function(){try{const t=r.readFileSync(c);return JSON.parse(t.toString())}catch(t){return console.info(`No settings file found at ${c}`),{}}},execCommand:function(t){return new Promise(((e,n)=>{o(t,((t,r,s)=>{t?n(t):s?n(`stderr: ${s}`):e(r)}))}))}}},2081:t=>{"use strict";t.exports=require("child_process")},7147:t=>{"use strict";t.exports=require("fs")},2037:t=>{"use strict";t.exports=require("os")}},e={};function n(r){var s=e[r];if(void 0!==s)return s.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}(()=>{const{exec:t}=n(2081),e=n(3992),{loadSettings:r,canMidiIn:s,canMidiOut:o,execCommand:c}=n(6451);(async function(){await c("aconnect -x");const t=await c("aconnect -i -l").then(e),n=r();t.forEach((e=>{o(n,e)&&e.ports.forEach((r=>{t.filter((t=>t.id!==e.id)).forEach((t=>{s(n,t)&&t.ports.forEach((n=>{c(`aconnect ${e.id}:${r} ${t.id}:${n}`)}))}))}))}))})().catch((t=>{console.error(t)}))})()})();