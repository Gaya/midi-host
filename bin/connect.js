#!/usr/bin/env node
SETTINGS_PATH="/home/pi/midi.settings.json",(()=>{var t={596:t=>{t.exports=function(t){const e=/^client (\d*): '(.*)' \[(.*)]\n(\s.+\n?)+/gm,n=[];let r;for(;r=e.exec(t);){const[t,e,o]=r,s=parseInt(e,10);if(0===s||o.indexOf("Through")>-1)continue;const i={name:o,id:s,ports:[]},c=/^\s+(\d+).+/gm;let a;for(;a=c.exec(t);){const[t,e]=a;i.ports.push(parseInt(e,10))}n.push(i)}return n}},847:(t,e,n)=>{const r=n(147),o=n(37),s=SETTINGS_PATH||process.env.SETTINGS_PATH||`${o.homedir()}/midi.settings.json`;function i(t,e){const n=t[e.name];return void 0===n?1:n}t.exports={canMidiIn:function(t,e){switch(i(t,e)){case 1:case 2:return!0;default:return!1}},canMidiOut:function(t,e){switch(i(t,e)){case 1:case 3:return!0;default:return!1}},loadSettings:function(){try{const t=r.readFileSync(s);return JSON.parse(t.toString())}catch(t){return console.info(`No settings file found at ${s}`),{}}}}},81:t=>{"use strict";t.exports=require("child_process")},147:t=>{"use strict";t.exports=require("fs")},37:t=>{"use strict";t.exports=require("os")}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var s=e[r]={exports:{}};return t[r](s,s.exports,n),s.exports}(()=>{const{exec:t}=n(81),e=n(596),{loadSettings:r,canMidiIn:o,canMidiOut:s}=n(847);function i(e){return new Promise(((n,r)=>{t(e,((t,e,o)=>{t?r(t):o?r(`stderr: ${o}`):n(e)}))}))}(async function(){await i("aconnect -x");const t=await i("aconnect -i -l").then(e),n=r();t.forEach((e=>{s(n,e)&&e.ports.forEach((r=>{t.filter((t=>t.id!==e.id)).forEach((t=>{o(n,t)&&t.ports.forEach((n=>{i(`aconnect ${e.id}:${r} ${t.id}:${n}`)}))}))}))}))})().catch((t=>{console.error(t)}))})()})();